{% extends 'base.html' %}

{% block content %}
{% if calculations %}

<div id="place_for_details"></div>

<table class="sortable" id="results_table">
    <caption>Results</caption>
    <tr>
        <th scope="col">Name</th>
        <th scope="col" class="sorttable_nosort">Tier</th>
        <th scope="col" class="sorttable_nosort">Subcategory</th>
        <th scope="col">Profit</th>
        <th scope="col">Profit %</th>
        <th scope="col" class="sorttable_nosort"></th>
    </tr>
    {% for record in calculations %}
    <tr>
        <td><img src="{{ url_for('static', filename='icons/' + record['product_id'] + '.png') }}" alt="Icon"
                 style="vertical-align: middle" loading="lazy" width="50" height="50"> {{ record['product_name'] }}
        </td>
        <td style="text-align:center">{{ record['product_tier'] }}</td>
        <td>{{ record['product_subcategory'] }}</td>
        <td>{{ record['profit_with_journals'] }}</td>
        <td>{{ record['profit_percentage'] }}</td>
        <td>
            <button id="details" onclick="show_details({{record}})">Details</button>
        </td>
    </tr>
    {% endfor %}
</table>
{% endif %}

<script type="text/javascript">
    function show_details(calculation) {
        $.ajax({
            url: "/details",
            type: "post",
            data: calculation,
            success: function (response) {
                $("#place_for_details").html(response);
            },
            error: function (xhr) {
                //Do Something to handle error
            }
        });
    }

</script>

{% endblock %}